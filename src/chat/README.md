# Chat 모듈

이 폴더는 FinOps RAG Agent의 자연어 질의 처리 및 SQL 생성 기능을 담당합니다.

## 파일 구조

### 핵심 파일들

#### `ask.py` (4.2KB)
- **역할**: 사용자 질문을 받아서 처리하는 메인 엔트리 포인트
- **주요 기능**:
  - 사용자 질문을 자연어로 받아서 SQL로 변환
  - SQL 실행 및 결과 포맷팅
  - 전체 질의 처리 파이프라인 관리

#### `nl2sql.py` (2.9KB)
- **역할**: Natural Language to SQL 변환
- **주요 기능**:
  - LLM을 사용하여 자연어 질문을 SQL 쿼리로 변환
  - 데이터베이스 스키마 정보 활용
  - SQL 문법 검증 및 최적화

#### `executor.py` (1.7KB)
- **역할**: SQL 쿼리 실행
- **주요 기능**:
  - 생성된 SQL 쿼리를 실제 데이터베이스에서 실행
  - 쿼리 결과를 DataFrame 형태로 반환
  - 에러 처리 및 로깅

#### `formatter.py` (3.2KB)
- **역할**: SQL 실행 결과 포맷팅
- **주요 기능**:
  - 쿼리 결과를 사용자 친화적인 형태로 변환
  - 자연어 요약 생성 (현재 주석처리됨)
  - 숫자 데이터 요약 정보 생성
  - 샘플 데이터 추출

#### `schema_provider.py` (2.1KB)
- **역할**: 데이터베이스 스키마 정보 제공
- **주요 기능**:
  - 테이블 구조 및 컬럼 정보 제공
  - 스키마 메타데이터 관리
  - NL2SQL 변환 시 컨텍스트 제공

#### `__init__.py` (963B)
- **역할**: 모듈 초기화 및 공개 인터페이스 정의
- **주요 기능**:
  - 외부에서 사용할 주요 함수들 export
  - 모듈 레벨 설정 관리

## 처리 흐름

1. **질문 입력** (`ask.py`)
   - 사용자가 자연어로 질문 입력

2. **스키마 정보 제공** (`schema_provider.py`)
   - 관련 테이블 및 컬럼 정보 수집

3. **SQL 변환** (`nl2sql.py`)
   - LLM을 사용하여 자연어를 SQL로 변환

4. **쿼리 실행** (`executor.py`)
   - 생성된 SQL을 데이터베이스에서 실행

5. **결과 포맷팅** (`formatter.py`)
   - 실행 결과를 사용자 친화적인 형태로 변환

6. **응답 반환** (`ask.py`)
   - 최종 결과를 사용자에게 반환

## 사용법

```python
from src.chat import ask

# 질문 처리
result = ask("8월 총 비용은 얼마인가요?")
print(result["answer"])
print(result["sql"])
```

## 현재 상태

- 자연어 요약 생성 기능이 주석처리되어 있어 SQL문만 출력됨
- LLM의 SQL 생성 품질 평가를 위한 디버깅 모드로 설정됨
